import os
import argparse
from src.communicator.multi_process_communication import MultiProcessCommunicator


def init(args):
    os.system('sudo hciconfig hci0 piscan')
    mcp = MultiProcessCommunicator(args)
    mcp.start()


if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    # for getting your algo ip address
    parser.add_argument('--name', type=str, default='yn')
    parser.add_argument('--enable_and', type=int, default=0)  # not used
    parser.add_argument('--enable_stm', type=int, default=0)
    parser.add_argument('--enable_alg', type=int, default=0)
    parser.add_argument('--enable_img', type=int, default=0)
    parser.add_argument('--test', type=int, default=0)
    # set to 1 if you want to use dummy functions to test
    parser.add_argument('--test_algo', type=int, default=0)
    parser.add_argument('--test_android', type=int, default=0)
    parser.add_argument('--test_stm', type=int, default=0)
    parser.add_argument('--test_img', type=int, default=0)
    parser.add_argument('--test_write', type=int, default=0)
    parser.add_argument('--test_write_android', type=int, default=0)

    args = parser.parse_args()

    if args.test:
        args.test_algo = 1
        args.test_android = 1
        args.test_stm = 1
        args.test_img = 1
        args.test_write = 1
        args.test_write_android = 1

    print(args)

    init(args)
